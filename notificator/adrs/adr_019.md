#### ID: ADR-019

#### Дата: 17.10.2023

#### Статус: Предложено

#### Участники:
* Евгений Климов

#### Введение:

Этот документ заменяет собой два ADR: [ADR-008 Очереди для обработки больших объемов](adr_008.md) и [ADR-012 Разработка функции хранимых с гарантией сообщений](adr_012.md)

## Использование очередей и шаблона проектирования "Планировщик" для обработки оповещений

**Решение:**

Для эффективной обработки оповещений и снижения нагрузки на систему оповещений будет использована комбинация очередей сообщений и шаблона проектирования "Планировщик". Оповещения будут сохраняться в базе данных, и затем планировщик будет регулярно проверять базу на наличие оповещений для отправки. Если оповещения будут доступны, планировщик их извлечет и отправит по требуемым каналам связи.

**Альтернативы:**
- Использование Apache Kafka: Вместо базы данных и шаблона проектирования "Планировщик" можно рассмотреть использование Apache Kafka или другой системы управления очередями. Kafka может быть полезен для обработки больших объемов сообщений, но потребует дополнительной настройки и экспертизы.
- RabbitMQ: В качестве альтернативы Apache Kafka можно рассмотреть RabbitMQ, который предоставляет гибкий и масштабируемый механизм управления очередями. Однако, он может иметь ограничения в обработке очень больших объемов сообщений.
- Использование AWS SQS: Amazon Simple Queue Service (SQS) - это управляемая служба очередей, предоставляемая Amazon Web Services. Она может быть использована для управления сообщениями и обеспечения масштабируемости.

**Контекст:**

Решение о выборе комбинации базы данных и шаблона проектирования "Планировщик" связано с потребностью эффективно обрабатывать оповещения и управлять нагрузкой на систему оповещений. Сохранение оповещений в базе данных позволяет гибко управлять ими и регулировать скорость отправки с помощью шаблона проектирования "Планировщик".

**Последствия:**

***Положительные:***
- Снижение нагрузки: Использование базы данных и шаблона проектирования "Планировщик" позволяет снизить нагрузку на систему оповещений, обеспечивая более плавную и предсказуемую производительность.
- Гибкость: Механизм хранения оповещений в базе данных обеспечивает гибкость в управлении их отправкой, позволяя задавать приоритеты и регулировать скорость.
- Отказоустойчивость: Копирование оповещений в базе данных обеспечивает отказоустойчивость в случае сбоев системы оповещений.

***Отрицательные:***
- Необходимость разработки планировщика: Разработка и внедрение планировщика потребует дополнительных ресурсов и времени.
- Требования к администрированию: Использование базы данных и шаблона проектирования "Планировщик" также подразумевает наличие опыта в администрировании системы управления оповещениями.

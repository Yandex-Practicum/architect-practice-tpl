#### ID: ADR_5

#### Дата: 2023.10.13

#### Статус: Принято

#### Участники:
> [Лица, участвующие или ответственные за принятие решения]
* Павел Морозов

#### Решения:
> [Краткие описания принятых архитектурных решений]
* для сбора метрик использовать Prometheus
* для "обзора" системы и алёртов использовать Grafana
  * данный компонент не отражен на диаграммах C4, т.к. на текущий момент находится не в рабочей области видимости

#### Контекст:
> [Контекст в рамках которого принимались решения, описывающий ситуацию, которая привела к тому какие решения были приняты]

Согласно [ADR_1](ADR/ADR_1.md) должна быть система для сбора и хранения метрик. Выбор пал на [Prometheus](https://prometheus.io). Обоснование выбора см. ниже.

#### Последствия:
> [Результаты к которым могут или гарантированно приведут принятые решения. Они могут быть как положительным так и отрицательными]

##### Положительные:
* для многих компонентов существуют готовые решения для сбора метрик
  * для БД/PostgreSQL это ([postgres_exporter](https://github.com/prometheus-community/postgres_exporter)) (см. [ADR_3](ADR_3.md))
  * для брокера сообщений/RabbitMQ это плагин `rabbitmq_prometheus`, см. [официальную документацию](https://www.rabbitmq.com/prometheus.html) (см. [ADR_4](ADR_4.md))
* в компании имеется опыт его применения
* популярный/распространенный инструмент
* open source решение

##### Отрицательные:
* в самописных сервисах придется добавлять фичу "метрики для Prometheus"
  * самый простой вариант: использовать [grok_exporter](https://github.com/fstab/grok_exporter),\
    т.е. метрики будем формировать из логов сервиса
* требует дополнительных затрат на поддержку

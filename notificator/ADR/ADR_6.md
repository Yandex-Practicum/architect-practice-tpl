#### ID: ADR_6

#### Дата: 2023.10.13

#### Статус: Принято

#### Участники:
> [Лица, участвующие или ответственные за принятие решения]
* Павел Морозов

#### Решения:
> [Краткие описания принятых архитектурных решений]

Сервис рассылки оповещений реализовывать на python3+fastapi.

#### Контекст:
> [Контекст в рамках которого принимались решения, описывающий ситуацию, которая привела к тому какие решения были приняты]

Согласно [ADR_1](ADR/ADR_1.md) должен быть "сервис рассылки оповещений", который управляет отправкой оповещений, вместе с фичами настройки и мультиплексирования отправки ("настройки" включают в себя "лимиты"). В качестве ЯП использовать [python3](https://www.python.org). В качестве веб фреймворка использовать [FastApi](https://fastapi.tiangolo.com). Обоснование выбора см. ниже.

#### Последствия:
> [Результаты к которым могут или гарантированно приведут принятые решения. Они могут быть как положительным так и отрицательными]

##### Положительные:
* касательно [python3](https://www.python.org)
  * поставленная задача является IO-bound, поэтому производительности python3 будет достаточно
    * к тому же существует проект [faster-cpython](https://github.com/faster-cpython), который уже повлиял на python 3.11/3.12. 
  * согласно [JetBrains  / The State of Developer Ecosystem 2022](https://www.jetbrains.com/lp/devecosystem-2022/) python3 является достаточно распространенным ЯП, поэтому не будет проблем с поиском разработчиков
  * в компании имеется опыт его применения
  * популярный/распространенный инструмент
  * open source решение
* касательно [FastApi](https://fastapi.tiangolo.com)
  * достаточно простой интерфейс
  * в компании имеется опыт его применения
  * популярный/распространенный инструмент
  * open source решение

##### Отрицательные:
* касательно [python3](https://www.python.org)
  * требует дисциплины в разработке
    * необходимо выбрать и настроить форматтер\
      ([black](https://github.com/psf/black) или [yapf](https://github.com/google/yapf))
    * необходимо настроить линтеры
      * причем несколько, т.к. 1 не сможет обнаружить все проблемы
      * предлагается использовать [qodana](https://www.jetbrains.com/qodana/), [wemake-python-styleguide](https://github.com/wemake-services/wemake-python-styleguide) и другие
    * нужен будет настроенный CI, в котором будут прогоняться выбранные форматтеры/линтеры
    * все разработчики должны писать код так, чтобы проходили форматтеры/линтеры
* касательно [FastApi](https://fastapi.tiangolo.com)
  * необходимо выбрать веб сервер
    * либо [uvicorn](https://www.uvicorn.org), либо [gunicorn](https://gunicorn.org) c `uvicorn.workers.UvicornWorker`
    * в любом случае они без фичи балансировки нагрузки, но это парируется наличием API Gateway (см. [ADR_2](ADR/ADR_2.md))

#### ID: ADR-004

#### Дата: 2023.10.07

#### Статус: Предложено

#### Участники:
* Абдрахманов Марат

#### Решения:
* За управление процессом отправки уведомлений отвечает Multiplexer Service, в части:
    * Принимает задания на рассылку из Kafka из топика send_notify.
    * Выплняет отправку уведомлений согласно заданию.
    * Может выполнять как адресную рассылку, так и групповую.
* За работу с сервисом отправки SMS отвечает SMS Gateway.
* За работу с сервисом отправки EMail отвечает EMail Gateway.
* За работу с сервисом отправки Push-уведомлений отвечает Push-notify Gateway.
* Связь между Multiplexer Service и перечисленными шлюзами осуществляется по gRPC.

#### Контекст:
Согласно ТЗ необходимо предусмотреть возможность мультиплексирования (рассылки одного сообщения по всем каналам группе клиентов) так и адресной отправки в каждый канал связи конкретным адресатам. Также учтесть природу разных каналов связи, их потенциальные ограничения и пропускную способность (например, ограничение количества символов в СМС, стоимость СМС, лимиты пуш-очередей провайдеров, возможность попадания e-mail в спам и т.д.). Для обработки этих особенностей в системе планируется использовать соответствующие Gateway'и. 

gRPC зарекомендовал себя как быстрый и надежный протокол с поддержкой во многих языках программирования, поэтому был выбран он.

#### Последствия:

#### Положительные:
* Поддержка мультиплексирования.
* Поддержка особенностей каналов уведомлений.
* Упрощение тестирования.

#### Отрицательные:
* Разработка четырех отдельных компонент вместо одного.
* Возможные проблемы со связью между мультиплексором и шлюзами.
# ADR-004

### ID: ADR-004

### Дата: 14.10.2023

### Статус: Принято

### Участники:

- Гатауллин Артур

### Решения:

- Использовать реляционную базу данных для хранилища настроек пользователя

### Контекст:

Архитектура подразумевает наличие хранилища для настроек оповещений пользователя. Необходимо решить, какую базу данных использовать: реляционную или нереляционную.

Характер настроек известен заранее из функциональных требований: вкл./выкл., адрес/номер/логин. Также требуется “моментальное” применение настроек: если пользователь отключил оповещения, то ему они не должны приходить “с этого момента”.

Отдел маркетинга показал краткий анализ конкурентов, из него возможно только лишь одно расширение настроек - до времени их действия: “отключить на час” / “отключить навсегда”.

### Альтернативы:

- Нереляционные базы данных
    - Одним из основых назначений нереляционных баз данных является работа с “большими данными”. Контекст текущей задачи не подразумевает хранения большим объемов данных: количество записей (настроек) определяется количеством пользователей, заранее определенная схема настроек краткая.
    - Одним из основных преимуществ нереляционных баз данных является их доступность. Для нашей задачи сверх-доступность не так важна:
        - Нет специальных требований для доступности по географии и тд
        - Чаще дополнительная доступность достигается в ущерб консистентности.
        - В качестве недоступности будем иметь запасной сценарий по умолчанию. Например, отправлять оповещение, даже если пользователь их отключил. При таком сценарии по умолчанию не будет различия в пользовательском пути для недоступных данных или неконсистентных данных.
    - Ещё одним преимуществом нереляционных бд является гибкость в схеме их хранения. Как указано в контексте, схема данных заранее определена, а их расширение маловероятно и минимально. Поэтому данный риск потери ресурсов при бо́льшем расширении принимаем.

### Последствия:

### Положительные:

- Оптимальность решения.
- Решение покрывает обязательное функциональное (не функциональное?) требование в “моментальности” применения настроек. Реляционные базы данных обеспечивают высокую консистентность данных. Ожидается, что при обновлении записи (настройки) в базе данных, каждый экземпляр бд с минимальной задержкой обновится до нового значения. (Чтобы отправить оповещение пользователю в соответствии с актуальной настройкой)
- Производительность.
- При обеспечении высокой консистентности данных, реализации реляционных бд достаточно производительны. Например, данные для определенной записи хранятся в в одном месте, нет необходимости обновлять в разных местах (в разных файлах или экземплярах) как в нереляционных бд.
#### ID: ADR-001

#### Дата: 2023.10.07

#### Статус: Предложено

#### Участники:
* Абдрахманов Марат

#### Решения:
В результате анализа требований к системе, ее процессов и данных были приняты следующие решения:
* Структура: Архитектурный стиль - архитектура микросервисов.
* Свойства системы: доступность, надежность, тестируемость, масштабируемость, безопасность, гибкость, отказоустойчивость, развертываемость, наблюдаемость.
* Архитектурные решения (некоторые):
    * Доступ к нашему сервису для внешних систем производится через Proxy.
    * Работа нашего сервиса с системами отправки уведомлений выполняется через специальные шлюзы.
    * Доступ к БД должны иметь только связанные с ними сервисы. БД не должны быть доступны внешним пользователям.
    * Работу с сервисами уведомлений может осуществлять только сервис мультиплексирования и отправки уведомлений, другие доступа к ним не должны иметь.
* Принципы проектирования (некоторые):
    * Для повышения производительности процесса отправки уведомлений взаимодействие между шлюзом, принимающим задания от внешних систем, сервисом уведомлений и сервисом мультиплексирования и отправки уведомлений должно осуществляться асинхронно.
    * Для взаимодействия с внешними сервисами по возможности использовать REST API.
    * Для синхронного взаимодействия сервисов внутри системы по возможности использовать gRPC.
    * Вести трассировку внешних взаимодействий.
    * Использовать метрики для анализа производительности системы и т.п.
    * Использовать централизованное хранилище логов с возможностью их анализа.
    * Параметры настройки каналов, данные пользователей и параметры рассылки хранить отдельно от информации об отправленных уведомлениях.

#### Контекст:
В данном случае мы имеем общий контекст задачи, описываемый заданием из файла README.md и определенными в результате анализа процессами и данными.

Анализ систем рассылки SMS, Push-уведомлений и EMail'ов показал, что многие из них поддерживают REST API, примеры:
- https://www.epochta.ru/products/sms/sms-api
- https://iqsms.ru/
- https://onesignal.com/

При подготовке данного ADR использовались информация из курса и книга "Фундаментальный подход к программной архитектуры" Марка Ричардса и Нила Форда.

#### Последствия:

#### Положительные:
* Все связи нашей системы в внешним миром осуществляются через Proxy или спец. шлюзы, которые частично решают задачи прокси, что повышает безопасность системы.
* Разделение на компоненты по выполняемым задачам позволит повысить тестируемость, гибкость и общую надежность системы.
* Использование асинхронного взаимодействия между ключевыми подсистемами позволит повысить общую производительность.
* Использование трассировки, сбора метрик и логов повысит общую наблюдаемость (observability) системы.
* Непрерывный рост объема данных об отправленных уведомлениях может потребовать реализации шардирования, поэтому при отделение этого хранилища данную задачу будет решить проще. 
* Хранение настроек каналов уведомлений и данных пользователя от другой информации повысит безопасность системы.

#### Отрицательные:
* Разделение на микросервисы потребует дополнительных затрат на учет особенностей межсетевого взаимодействия (задержки, отсутствие связи, изменение топологии, неоднородность сети и т.п.).
* Необходимо наличие инфраструктуры для развертывания такого решения.